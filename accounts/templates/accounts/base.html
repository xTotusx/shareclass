{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="manifest" href="{% static 'accounts/manifest.json' %}">
  <meta name="theme-color" content="#185a9d">

  <title>{% block title %}ShareClass{% endblock %}</title>

  <style>
    /* =========================================
       ESTILOS DEL MEN√ö MAESTRO
       ========================================= */
    .menu-container {
      position: relative;
      display: inline-block;
    }

    /* El bot√≥n principal del men√∫ */
    .menu-btn {
      background: rgba(255, 255, 255, 0.2);
      color: white;
      padding: 10px 20px;
      border-radius: 30px;
      text-decoration: none;
      font-weight: bold;
      cursor: pointer;
      border: 1px solid rgba(255,255,255,0.3);
      transition: background 0.3s, transform 0.2s;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .menu-btn:hover {
      background: rgba(255, 255, 255, 0.3);
    }

    /* El contenido desplegable */
    .dropdown-content {
      display: none;
      position: absolute;
      right: 0; /* Alineado a la derecha para no salirse del margen */
      top: 110%; /* Justo debajo del bot√≥n */
      background-color: rgba(15, 61, 92, 0.95); /* Azul oscuro corporativo */
      min-width: 220px;
      box-shadow: 0px 8px 30px rgba(0,0,0,0.5);
      border-radius: 12px;
      backdrop-filter: blur(15px);
      border: 1px solid rgba(255,255,255,0.1);
      z-index: 10000;
      overflow: hidden;
      padding: 5px 0;
    }

    /* Enlaces del men√∫ */
    .dropdown-content a {
      color: white !important;
      padding: 12px 20px;
      text-decoration: none;
      display: block;
      font-size: 0.95rem;
      border-bottom: 1px solid rgba(255,255,255,0.05);
      transition: background 0.2s, padding-left 0.2s;
    }

    .dropdown-content a:last-child {
      border-bottom: none;
    }

    .dropdown-content a:hover {
      background-color: rgba(255,255,255,0.1);
      padding-left: 25px; /* Peque√±o efecto de movimiento */
      color: #43cea2 !important; /* Color de acento al hover */
    }

    /* Separadores de secci√≥n (ej: "ADMINISTRACI√ìN") */
    .menu-divider {
      font-size: 0.75rem;
      color: rgba(255,255,255,0.5);
      padding: 10px 20px 5px 20px;
      text-transform: uppercase;
      letter-spacing: 1px;
      font-weight: bold;
      pointer-events: none; /* No clickeable */
      margin-top: 5px;
    }

    /* Mostrar men√∫ al pasar el mouse (hover) */
    .menu-container:hover .dropdown-content {
      display: block;
      animation: slideIn 0.2s ease-out;
    }

    /* Animaci√≥n de entrada */
    @keyframes slideIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Bot√≥n especial de cerrar sesi√≥n */
    .logout-link {
      background: rgba(255, 75, 75, 0.1);
    }
    .logout-link:hover {
      background: rgba(255, 75, 75, 0.3) !important;
      color: white !important;
    }

  </style>

  {% block styles %}
  {% endblock %}
</head>

<body>

  {% if user.is_authenticated %}
  <nav style="
    position:sticky;
    top:0;
    width:100%;
    padding:1rem 2rem;
    background:rgba(0,0,0,0.3);
    display:flex;
    justify-content:space-between;
    align-items:center;
    backdrop-filter:blur(8px);
    border-bottom:1px solid rgba(255,255,255,0.1);
    z-index: 9999;
    box-sizing: border-box; /* Asegura que el padding no rompa el ancho */
  ">
    
    <div class="logo">
      <a href="{% url 'home' %}">
        <img src="{% static 'accounts/shareclass_logo.jpeg' %}" alt="Logo" style="height:45px; border-radius: 8px; vertical-align: middle;">
      </a>
    </div>

    <div class="menu-container">
      <div class="menu-btn">
        <span>Men√∫</span>
        <span style="font-size:1.2rem;">‚ò∞</span>
      </div>

      <div class="dropdown-content">
        <a href="{% url 'home' %}">üè† Inicio</a>
        
        <div class="menu-divider">Inventario</div>
        <a href="{% url 'libros_home' %}">üìö Biblioteca</a>
        <a href="{% url 'dispositivos_home' %}">üíª Dispositivos</a>

        <div class="menu-divider">Mi Cuenta</div>
        <a href="{% url 'perfil' %}">üë§ Perfil</a>

        {% if request.user.profile.role == "admin" or request.user.is_superuser %}
          <div class="menu-divider" style="color: #ff9068;">Administraci√≥n</div>
          <a href="{% url 'admin_dashboard' %}">üìä Panel de Control</a>
          <a href="{% url 'user_list' %}">üë• Gesti√≥n de Usuarios</a>
        {% endif %}

        <div style="border-top: 1px solid rgba(255,255,255,0.1); margin-top:5px;"></div>
        <a href="{% url 'logout' %}" class="logout-link">üö™ Cerrar sesi√≥n</a>
      </div>
    </div>

  </nav>
  {% endif %}

  {% block content %}
  {% endblock %}

  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register("{% static 'accounts/service-worker.js' %}")
          .then(registration => console.log('Service Worker registrado:', registration.scope))
          .catch(error => console.log('Error SW:', error));
      });
    }
  </script>

</body>
</html>